{
  "name": "dag-visualize",
  "description": "Generate DAG state visualization with QR-Avalanche consensus details",
  "agent": "consensus_agent",
  "context": {
    "agent_reference": "agents/consensus_agent.md",
    "algorithm": "QR-Avalanche",
    "visualization_templates": {
      "consensus_flow": "Shows node voting patterns and finality progression",
      "dag_structure": "Displays DAG topology with edge weights and confidence scores",
      "performance_metrics": "Visualizes throughput, latency, and finality time",
      "fork_resolution": "Illustrates how forks are detected and resolved"
    }
  },
  "parameters": {
    "state": {
      "type": "string",
      "description": "DAG state to visualize (current, snapshot-id, consensus, forks, metrics)",
      "required": true,
      "options": ["current", "snapshot-{id}", "consensus", "forks", "metrics", "finality"]
    },
    "format": {
      "type": "string",
      "description": "Output format (svg, png, dot, json)",
      "required": false,
      "default": "svg"
    },
    "depth": {
      "type": "number",
      "description": "DAG depth to visualize (default: 10)",
      "required": false,
      "default": 10
    },
    "highlight": {
      "type": "string",
      "description": "Highlight specific aspects (votes, conflicts, finalized)",
      "required": false
    }
  },
  "examples": [
    "/dag-visualize current",
    "/dag-visualize snapshot-123 --format png --depth 20",
    "/dag-visualize consensus --format dot --highlight votes",
    "/dag-visualize forks --highlight conflicts",
    "/dag-visualize metrics --format json"
  ],
  "output": {
    "success": "Generated DAG visualization with consensus state",
    "format": [
      "1. Visualization File (format: {format})",
      "2. Node Statistics (total, finalized, pending)",
      "3. Edge Statistics (total, validated, weight distribution)",
      "4. QR-Avalanche Consensus Status",
      "   - Current round: {round}",
      "   - Voting progress: {votes}/{required}",
      "   - Finality depth: {depth}",
      "   - Fork detection: {active_forks}",
      "5. Performance Metrics",
      "   - Throughput: {msgs/sec}",
      "   - Finality latency: {p50, p99}",
      "   - DAG growth rate: {nodes/sec}"
    ]
  },
  "metrics": {
    "consensus_health": {
      "voting_participation": "Percentage of nodes voting",
      "finality_rate": "Blocks finalized per second",
      "fork_frequency": "Fork occurrences per hour",
      "reorg_depth": "Average reorganization depth"
    },
    "dag_metrics": {
      "node_count": "Total nodes in DAG",
      "edge_count": "Total edges in DAG",
      "avg_degree": "Average node degree",
      "max_depth": "Maximum DAG depth"
    }
  },
  "error_handling": {
    "invalid_state": "State validation error - check state parameter",
    "render_failure": "Visualization generation error - check format support",
    "format_error": "Invalid output format - use svg, png, dot, or json",
    "depth_exceeded": "Requested depth exceeds available data",
    "consensus_unavailable": "Consensus data not available for requested state"
  }
}