{
  "name": "crypto-validate",
  "description": "Validate quantum-resistant cryptographic implementation against test vectors and security requirements",
  "agent_context": {
    "primary": "agents/crypto_agent.md",
    "workflow": "workflow/security_workflow.md",
    "security_context": "contexts/security_context.md"
  },
  "parameters": {
    "algorithm": {
      "type": "string",
      "description": "Quantum-resistant cryptographic algorithm to validate (ml-kem, ml-dsa, hqc)",
      "required": true,
      "enum": ["ml-kem", "ml-dsa", "hqc", "ml-kem-768", "ml-dsa-65"]
    },
    "options": {
      "type": "object",
      "description": "Validation options",
      "properties": {
        "test_vectors": {
          "type": "boolean",
          "description": "Validate against NIST test vectors",
          "default": true
        },
        "timing_analysis": {
          "type": "boolean",
          "description": "Perform constant-time analysis",
          "default": true
        },
        "memory_safety": {
          "type": "boolean",
          "description": "Check secure memory handling",
          "default": true
        }
      }
    }
  },
  "examples": [
    "/crypto-validate ml-kem",
    "/crypto-validate ml-dsa --timing-analysis --memory-safety",
    "/crypto-validate hqc --test-vectors",
    "/crypto-validate ml-kem-768 --all"
  ],
  "test_vectors": {
    "ml-kem": "core/crypto/tests/.test_vectors/mlkem768_*.txt",
    "ml-dsa": "core/crypto/tests/.test_vectors/mldsa65_*.txt",
    "hqc": "core/crypto/tests/.test_vectors/hqc_*.txt"
  },
  "validation_steps": [
    {
      "step": "Test Vector Validation",
      "description": "Validate against NIST PQC test vectors",
      "files": ["core/crypto/tests/ml_kem_tests.rs", "core/crypto/tests/ml_dsa_tests.rs"]
    },
    {
      "step": "Constant-time Analysis",
      "description": "Verify operations are constant-time",
      "tools": ["dudect", "ct-verif"],
      "files": ["core/crypto/tests/security/timing_analysis_tests.rs"]
    },
    {
      "step": "Memory Safety Check",
      "description": "Ensure secure memory handling and zeroization",
      "files": ["core/crypto/tests/security/memory_tests.rs"]
    },
    {
      "step": "Known Attack Resistance",
      "description": "Test against known quantum and classical attacks",
      "attacks": ["side-channel", "timing", "fault-injection", "quantum"]
    },
    {
      "step": "Compliance Report",
      "description": "Verify NIST PQC compliance",
      "standards": ["FIPS 203", "FIPS 204", "FIPS 205"]
    }
  ],
  "output": {
    "success": "Comprehensive cryptographic validation report",
    "format": [
      "1. Test Vector Validation Results",
      "   - NIST vector compliance: PASS/FAIL",
      "   - Custom vector tests: X/Y passed",
      "2. Constant-time Analysis",
      "   - Timing variance: < 0.01%",
      "   - Statistical tests: PASS/FAIL",
      "3. Memory Safety Check",
      "   - Zeroization: VERIFIED",
      "   - No memory leaks: CONFIRMED",
      "4. Known Attack Resistance",
      "   - Side-channel: RESISTANT",
      "   - Quantum attacks: RESISTANT",
      "5. Compliance Report",
      "   - NIST PQC: COMPLIANT",
      "   - Security level: X bits"
    ]
  },
  "error_handling": {
    "invalid_algorithm": "Supported algorithms: ml-kem, ml-dsa, hqc",
    "validation_failure": "Detailed validation error with specific test case",
    "security_concern": "Critical security issue requiring immediate attention",
    "test_vector_missing": "Required test vectors not found at expected path"
  },
  "security_requirements": {
    "constant_time": "All operations must be constant-time",
    "memory_safety": "Secrets must be zeroized after use",
    "side_channel": "Implementation must resist timing attacks",
    "quantum_resistance": "Meet NIST PQC security levels"
  }
}