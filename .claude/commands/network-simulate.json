{
  "name": "network-simulate",
  "description": "Run network simulation scenarios with P2P, routing, and dark addressing features",
  "agent": "agents/network_agent.md",
  "contexts": [
    "contexts/performance_context.md",
    "contexts/test_status.md"
  ],
  "parameters": {
    "scenario": {
      "type": "string",
      "description": "Network scenario to simulate",
      "required": true,
      "options": [
        "basic_connectivity",
        "partition",
        "latency",
        "byzantine",
        "sybil_attack",
        "routing_attack",
        "dark_address_discovery",
        "onion_routing",
        "high_load",
        "network_churn"
      ]
    },
    "nodes": {
      "type": "number",
      "description": "Number of nodes to simulate",
      "required": false,
      "default": 10
    },
    "duration": {
      "type": "number",
      "description": "Simulation duration in seconds",
      "required": false,
      "default": 60
    },
    "attack_params": {
      "type": "object",
      "description": "Attack-specific parameters for adversarial scenarios",
      "required": false,
      "properties": {
        "attacker_ratio": "Ratio of malicious nodes",
        "attack_intensity": "Attack intensity level (0-1)",
        "target_nodes": "Specific nodes to target"
      }
    },
    "network_conditions": {
      "type": "object",
      "description": "Network condition parameters",
      "required": false,
      "properties": {
        "latency_ms": "Base network latency in milliseconds",
        "loss_rate": "Packet loss rate (0-1)",
        "partition_prob": "Network partition probability"
      }
    }
  },
  "scenario_templates": {
    "basic_connectivity": {
      "description": "Test basic P2P connectivity and message propagation",
      "metrics": ["connection_count", "message_delivery_rate", "routing_efficiency"]
    },
    "partition": {
      "description": "Simulate network partitions and recovery",
      "metrics": ["partition_detection_time", "recovery_time", "message_consistency"]
    },
    "dark_address_discovery": {
      "description": "Test dark addressing system and address resolution",
      "metrics": ["address_resolution_time", "anonymity_preservation", "lookup_success_rate"]
    },
    "onion_routing": {
      "description": "Validate onion routing and anonymous message delivery",
      "metrics": ["routing_layers", "latency_overhead", "anonymity_set_size"]
    },
    "sybil_attack": {
      "description": "Test resistance to Sybil attacks",
      "metrics": ["sybil_detection_rate", "consensus_integrity", "network_fragmentation"]
    },
    "routing_attack": {
      "description": "Simulate routing manipulation attacks",
      "metrics": ["routing_accuracy", "message_interception_rate", "path_diversity"]
    }
  },
  "examples": [
    "/network-simulate basic_connectivity",
    "/network-simulate partition --nodes 20",
    "/network-simulate byzantine --nodes 50 --duration 120",
    "/network-simulate dark_address_discovery --nodes 30",
    "/network-simulate sybil_attack --attack_params '{\"attacker_ratio\": 0.3}'",
    "/network-simulate onion_routing --network_conditions '{\"latency_ms\": 50}'"
  ],
  "output": {
    "success": "Network simulation results with performance metrics",
    "format": [
      "1. Simulation Configuration",
      "   - Scenario: {scenario}",
      "   - Node Count: {nodes}",
      "   - Duration: {duration}s",
      "   - Network Conditions: {conditions}",
      "2. Network Topology",
      "   - P2P Connections: {connection_metrics}",
      "   - Dark Addresses: {dark_address_count}",
      "   - Routing Paths: {routing_diversity}",
      "3. Performance Metrics",
      "   - Throughput: {messages_per_second}",
      "   - Latency (p99): {latency_99th_percentile}ms",
      "   - Message Delivery Rate: {delivery_rate}%",
      "4. Security Analysis",
      "   - Anonymity Set Size: {anonymity_metrics}",
      "   - Attack Detection: {security_events}",
      "   - Network Resilience: {resilience_score}",
      "5. Resource Usage",
      "   - Memory: {memory_usage}MB",
      "   - CPU: {cpu_usage}%",
      "   - Bandwidth: {bandwidth_usage}",
      "6. Recommendations",
      "   - Optimization Opportunities",
      "   - Security Improvements",
      "   - Scalability Considerations"
    ]
  },
  "performance_targets": {
    "throughput": "10,000+ messages/second",
    "latency_p99": "< 1000ms",
    "memory_usage": "< 100MB per node",
    "scalability": "Linear with node count"
  },
  "error_handling": {
    "invalid_scenario": "Unknown scenario. Valid options: {valid_scenarios}",
    "resource_limit": "Simulation requires more resources than available",
    "simulation_error": "Simulation failed: {error_details}",
    "network_failure": "Failed to initialize network: {failure_reason}"
  },
  "related_commands": [
    "/debug-network",
    "/performance-benchmark network",
    "/security-audit network",
    "/tdd-cycle network"
  ]
}