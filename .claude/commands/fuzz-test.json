{
  "name": "fuzz-test",
  "description": "Execute fuzzing campaign against target component with focus on security vulnerabilities",
  "agent_context": {
    "primary": "agents/security_agent.md",
    "crypto": "agents/crypto_agent.md",
    "workflow": "workflow/security_workflow.md",
    "security_context": "contexts/security_context.md"
  },
  "parameters": {
    "target": {
      "type": "string",
      "description": "Component to fuzz test",
      "required": true,
      "enum": [
        "crypto-ml-kem",
        "crypto-ml-dsa",
        "crypto-hqc",
        "crypto-input",
        "network-messages",
        "dag-consensus",
        "protocol-state",
        "serialization",
        "input-validation"
      ]
    },
    "duration": {
      "type": "string",
      "description": "Duration of fuzzing campaign",
      "required": false,
      "default": "1h",
      "pattern": "^\\d+[hms]$"
    },
    "options": {
      "type": "object",
      "description": "Fuzzing options",
      "properties": {
        "corpus": {
          "type": "string",
          "description": "Path to seed corpus",
          "default": "fuzz/corpus/{target}"
        },
        "max_len": {
          "type": "integer",
          "description": "Maximum input length",
          "default": 10240
        },
        "sanitizers": {
          "type": "array",
          "description": "Enable sanitizers",
          "items": {
            "enum": ["address", "memory", "undefined", "thread"]
          },
          "default": ["address", "memory"]
        }
      }
    }
  },
  "crypto_targets": {
    "crypto-ml-kem": {
      "description": "Fuzz ML-KEM encapsulation/decapsulation",
      "harness": "fuzz/fuzz_targets/crypto_ml_kem.rs",
      "focus": ["malformed_keys", "invalid_ciphertexts", "edge_cases"]
    },
    "crypto-ml-dsa": {
      "description": "Fuzz ML-DSA signing/verification",
      "harness": "fuzz/fuzz_targets/crypto_ml_dsa.rs",
      "focus": ["malformed_signatures", "invalid_messages", "key_corruption"]
    },
    "crypto-hqc": {
      "description": "Fuzz HQC encryption/decryption",
      "harness": "fuzz/fuzz_targets/crypto_hqc.rs",
      "focus": ["invalid_parameters", "malformed_ciphertexts", "timing_attacks"]
    },
    "crypto-input": {
      "description": "General crypto input validation",
      "harness": "fuzz/fuzz_targets/crypto_fuzz.rs",
      "focus": ["buffer_overflows", "integer_overflows", "panic_conditions"]
    }
  },
  "examples": [
    "/fuzz-test crypto-ml-kem",
    "/fuzz-test crypto-ml-dsa --duration 2h",
    "/fuzz-test network-messages --duration 30m --sanitizers address,thread",
    "/fuzz-test dag-consensus --max-len 50000",
    "/fuzz-test crypto-input --corpus fuzz/seed-corpus/crypto"
  ],
  "fuzz_targets": {
    "location": "fuzz/fuzz_targets/",
    "build_command": "cargo +nightly fuzz build",
    "run_command": "cargo +nightly fuzz run {target} -- {options}"
  },
  "output": {
    "success": "Comprehensive fuzzing campaign report",
    "format": [
      "1. Campaign Summary",
      "   - Target: {target}",
      "   - Duration: {actual_duration}",
      "   - Total executions: {exec_count}",
      "   - Executions/sec: {exec_per_sec}",
      "2. Code Coverage",
      "   - Line coverage: {line_coverage}%",
      "   - Branch coverage: {branch_coverage}%",
      "   - New edges found: {new_edges}",
      "3. Found Issues",
      "   - Crashes: {crash_count}",
      "   - Timeouts: {timeout_count}",
      "   - Memory leaks: {leak_count}",
      "   - Security issues: {security_count}",
      "4. Crash Reports",
      "   - Unique crashes: {unique_crashes}",
      "   - Crash artifacts: fuzz/artifacts/{target}/",
      "   - Minimized inputs: fuzz/corpus/{target}/",
      "5. Security Analysis",
      "   - Timing variations: {timing_issues}",
      "   - Memory safety: {memory_issues}",
      "   - Input validation: {validation_issues}",
      "6. Recommendations",
      "   - Priority fixes: [...]",
      "   - Additional fuzzing: [...]",
      "   - Security hardening: [...]"
    ]
  },
  "error_handling": {
    "invalid_target": "Valid targets: crypto-ml-kem, crypto-ml-dsa, crypto-hqc, crypto-input, network-messages, dag-consensus, protocol-state",
    "timeout": "Fuzzing campaign exceeded duration limit",
    "resource_exhaustion": "System resources exhausted (memory/disk)",
    "build_failure": "Failed to build fuzz target",
    "corpus_missing": "Seed corpus not found at specified path"
  },
  "security_focus": {
    "crypto": [
      "Constant-time violations",
      "Memory disclosure",
      "Invalid state transitions",
      "Buffer overflows",
      "Integer overflows"
    ],
    "network": [
      "Protocol violations",
      "Message corruption",
      "DoS conditions",
      "Resource exhaustion"
    ],
    "consensus": [
      "Byzantine behavior",
      "State corruption",
      "Fork conditions",
      "Liveness attacks"
    ]
  }
}